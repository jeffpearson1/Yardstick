url: https://qgis.org/download/
urlredirects: false
preDownloadScript: |
  $Content = Invoke-WebRequest $url
  $URL = $(($Content.Links | Where-Object href -like "*msi*" | Where-Object outerHTML -like "*Latest*" | Where-Object outerHTML -notlike "*experimental*").href)
  $filename = ($URL -split "\/")[-1]
  $filename -match "[0-9]{1,2}\.[0-9]{1,2}\.[0-9]{1,2}" | Out-Null
  $Version = $matches[0]
powershellInstallScript: | 
  Invoke-WebRequest -Uri "https://github.com/google/fonts/raw/main/ofl/opensans/OpenSans%5Bwdth,wght%5D.ttf" -UseBasicParsing
  if (Test-Path -Path "C:\ProgramData\Microsoft\Windows\Start Menu\Programs\QGIS*") {
    Remove-Item -Path "C:\ProgramData\Microsoft\Windows\Start Menu\Programs\QGIS*" -Recurse -Force
  }
  Start-Process -FilePath "msiexec" -ArgumentList "/i `"<filename>`" INSTALLDIR=`"$env:ProgramFiles\QGIS`" /qn /norestart" -Wait
  Get-ChildItem "C:\ProgramData\Microsoft\Windows\Start Menu\Programs\QGIS*" -Directory | Select-Object -First 1 | Rename-Item -NewName "QGIS" -Force
installScript: |
  %SystemRoot%\sysnative\WindowsPowerShell\v1.0\powershell.exe -noprofile -executionpolicy bypass -file .\install.ps1
uninstallScript: msiexec /x <productcode> /qn /norestart
iconFile: qgis.png
id: qgis
displayName: QGIS
publisher: QGIS
description: QGIS is a geographic information system (GIS) software that is free and open-source. It supports viewing, editing, printing, and analysis of geospatial data in a range of data formats. [Source\:Wikipedia]
detectionType: msi
installExperience: system
restartBehavior: suppress
scopeTags:
  - scopeTag1
  - scopeTag2