url:
urlredirects: false
preDownloadScript: |
  $html = $(Invoke-WebRequest "https://www.python.org/downloads/windows/").Content
  $html -match "Latest Python 3 Release - Python 3\.[0-9]{1,3}\.[0-9]{1,3}" | Out-Null
  $version = $($($matches[0] -split "-")[1]).Trim(" Python")
  $url = "https://www.python.org/ftp/python/$version/python-$version-amd64.exe"
  $fileName = "python-$version-amd64.exe"
installScript:
  '<filename> /quiet InstallAllUsers=1 PrependPath=1'
uninstallScript:
  '<filename> /quiet /uninstall'
version:
fileName:
iconFile: python3.png
id: python3
displayName: Python 3
publisher: Python Software Foundation
description: Python is a programming language that lets you work quickly and integrate systems effectively.
fileType: EXE
softwareName: "Python 3*"
dependentApplicationBlacklist:
 - "Python Config"
detectionType: script
detectionScript: |
  $version = "<version>"
  $version -match "[0-9]{1,3}\.[0-9]{1,3}" | Out-Null
  $dirVersion = $matches[0]
  $filePath = "C:\Program Files\Python$($dirVersion -replace "\.")"
  $installedVersion = $null

  if (Test-Path "$filePath\python.exe") {
      $installedVersionOutput = $(& "$filePath\python.exe" --version 2>&1).Trim()
      if ($installedVersionOutput -match 'Python\s+([\d\.]+)') {
          $installedVersion = $matches[1]
      }
  }

  if ($installedVersion -eq $version) {
      Write-Output "Detected"
      exit 0
  }

  Write-Output "Not Detected"
  exit 1
scopeTags:
  - scopeTag1
  - scopeTag2