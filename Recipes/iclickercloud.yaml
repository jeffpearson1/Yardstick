url: https://www.iclicker.com/downloads/iclicker-cloud/
urlredirects: false
preDownloadScript: |
  $content = Invoke-WebRequest $url
  $URL = ($content.links | where-object href -like "*msi*").href
  $readableURL = $URL -replace "%20", " "
  $readableURL -match "([0-9]{1,}\.){1,3}[0-9]{1,}" | Out-Null
  $version = $matches[0]
  $filename = ($readableURL -split "/")[-1]
powershellInstallScript: |
  # Install iClicker Cloud
  $iClickerInstallPath = "C:\ProgramData\iClickerCloud"
  $iClickerInstaller = "<filename>"
  $iClickerFullInstallPath = Join-Path -Path $iClickerInstallPath -ChildPath $iClickerInstaller

  if (!(Test-Path -Path $iClickerInstallPath)) {
      New-Item -Path $iClickerInstallPath -ItemType Directory -Force
  }

  Copy-Item -Path "$PSScriptRoot\$iClickerInstaller" -Destination $iClickerInstallPath -Recurse -Force
  Start-Process -FilePath msiexec.exe -ArgumentList "/i `"$iClickerFullInstallPath`" /qn /norestart" -Wait
powershellUninstallScript: |
  # Uninstall iClicker Cloud
  Start-Process -FilePath "msiexec.exe" -ArgumentList "/X <productcode> /qn /norestart" -Wait

  # Remove iClicker Cloud Directories
  if (Test-Path -Path "C:\Program Files\Macmillan Learning"){
      Remove-Item -Path "C:\Program Files\Macmillan Learning" -Recurse -Force
  }

  # Remove iClicker installer
  if (Test-Path -Path "C:\ProgramData\iClickerCloud") {
      Remove-Item -Path "C:\ProgramData\iClickerCloud" -Recurse -Force
  }
version:
iconFile: iclickercloud.png
id: iclickercloud
displayName: DEV iClicker Cloud
publisher: iClicker
description: Engage your students in new ways with iClicker Cloud (formerly Reef Instructor). Track attendance using GPS technology, ask target (heat map) questions, administer quizzes, and analyze student performance using a web browser. Students participate using mobile devices, laptops, and iClicker remotes.
detectionType: msi
installExperience: system
restartBehavior: suppress
minOSVersion: W11_22H2
scopeTags:
  - scopeTag1
  - scopeTag2