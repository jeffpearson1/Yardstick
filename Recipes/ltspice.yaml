url: https://ltspice.analog.com/software/LTspice64.msi
urlRedirects: false
preDownloadScript: |
  $downloadPage = "https://www.analog.com/en/resources/design-tools-and-calculators/ltspice-simulator.html"
  $driver = Start-SeDriver -Browser "Firefox" -StartURL $downloadPage #-Arguments @('--headless')
  Start-Sleep -Seconds 5 # Wait for page to load
  $version = ((Get-SeElement -By xpath "//a[@href='https://ltspice.analog.com/software/LTspice64.msi']/../../span[contains(text(), 'Version')]").Text -split "\ ")[1]
  if ($driver) {
      $driver.close()
  }
  if ($version -notmatch "([0-9]+\.[0-9]+\.[0-9]+)") {
    throw "Unable to parse LTspice version number from Analog Devices download page."
  }
downloadScript: Start-BitsTransfer -Source $url -Dynamic
installScript: msiexec /i <filename> /qn /norestart ALLUSERS=1 AI_INSTALLPERUSER=3
uninstallScript: msiexec /x <productcode> /qn /norestart
fileName: LTspice64.msi
iconFile: ltspice.png
id: LTSpice
displayName: DEV LTspice
publisher: Analog Devices
description: LTspiceÂ® is a powerful, fast, and free SPICE simulator software, schematic capture and waveform viewer with enhancements and models for improving the simulation of analog circuits.
dependentApplicationBlacklist:
 - "LTSpice Config"
fileType: msi
detectionType: msi
installExperience: user
restartBehavior: suppress
minOSVersion: W11_23H2
numVersionsToKeep: 2
scopeTags:
  - scopeTag1
  - scopeTag2
