url:
urlredirects: false
preDownloadScript: |
  using module .\Modules\VersionPro.psm1
  $downloadInfo = Get-JetbrainsAppDownloadLink -ProductName "PyCharm" -Channel "release" -Latest
  $version = $downloadInfo.Version
  $fileName = $downloadInfo.FileName
  $url = $downloadInfo.DownloadUrl
  $fileDetectionVersion = [VersionPro]::new($version).ToString(4)
  $fileDetectionPath = "C:\Program Files\JetBrains\PyCharm $version\bin"
postDownloadScript: |
  # Create silent.config file
  $silentConfig = @"
  ; Installation mode. It can be user or admin.
  ; NOTE: for admin mode please use "Run as Administrator" for command prompt to avoid UAC dialog.
  mode=admin

  ; Desktop shortcut for launchers
  launcher32=0
  launcher64=0

  ; Add launchers path to PATH env variable
  updatePATH=0

  ; Add "Open Folder as Project" to context menu
  updateContextMenu=0

  ; Download and install jre32
  jre32=0

  ; Regenerating the Shared Archive
  ; https://docs.oracle.com/en/java/javase/11/vm/class-data-sharing.html
  regenerationSharedArchive=1

  ; List of associations. To create an association change value to 1.
  .py=0
  "@
  $silentConfig | Out-File -FilePath "silent.config" -Encoding ASCII
installScript: <filename> /S /CONFIG=%~dp0silent.config
uninstallScript: |
  powershell.exe -noprofile -executionpolicy bypass -command "& { Get-ChildItem 'C:\Program Files\JetBrains' -Filter 'PyCharm*' | ForEach-Object { Start-Process -FilePath (Join-Path $_.FullName 'bin\Uninstall.exe') -ArgumentList '/S' -Wait } }"
iconFile: pycharm.png
id: pycharm
displayName: JetBrains PyCharm
publisher: JetBrains
description: PyCharm is a dedicated Python IDE providing a wide range of essential tools for Python developers, tightly integrated to create a convenient environment for productive Python, web, and data science development.
fileType: exe
detectionType: file
fileDetectionName: pycharm64.exe
fileDetectionMethod: exists
installExperience: system
restartBehavior: suppress
scopeTags:
  - scopeTag1
  - scopeTag2